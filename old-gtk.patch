diff -up gnome-panel-2.30.2/configure.in.old-gtk gnome-panel-2.30.2/configure.in
--- gnome-panel-2.30.2/configure.in.old-gtk	2010-06-22 19:28:21.530746319 -0400
+++ gnome-panel-2.30.2/configure.in	2010-06-22 19:31:54.460761735 -0400
@@ -54,7 +54,7 @@ LIBGNOME_DESKTOP_REQUIRED=2.24.0
 GDK_PIXBUF_REQUIRED=2.7.1
 PANGO_REQUIRED=1.15.4
 GLIB_REQUIRED=2.18.0
-GTK_REQUIRED=2.19.7
+GTK_REQUIRED=2.18.0
 LIBBONOBOUI_REQUIRED=2.1.1
 ORBIT_REQUIRED=2.4.0
 LIBWNCK_REQUIRED=2.19.5
@@ -75,9 +75,12 @@ PKG_CHECK_MODULES(PANEL, ORBit-2.0 >= $O
 AC_SUBST(PANEL_CFLAGS)
 AC_SUBST(PANEL_LIBS)
 
+AC_CHECK_LIB(gtk-x11-2.0, gtk_widget_get_mapped,[],PANEL_CFLAGS="$PANEL_CFLAGS '-Dgtk_widget_get_realized(w)=GTK_WIDGET_REALIZED(w)' '-Dgtk_widget_get_mapped(w)=GTK_WIDGET_MAPPED(w)'")
+
 PKG_CHECK_MODULES(LIBPANEL_APPLET, ORBit-2.0 >= $ORBIT_REQUIRED gtk+-2.0 >= $GTK_REQUIRED libbonoboui-2.0 >= $LIBBONOBOUI_REQUIRED gconf-2.0 >= $GCONF_REQUIRED)
 AC_SUBST(LIBPANEL_APPLET_CFLAGS)
 AC_SUBST(LIBPANEL_APPLET_LIBS)
+AC_CHECK_LIB(gtk-x11-2.0, gtk_widget_get_mapped,[],LIBPANEL_APPLET_CFLAGS="$LIBPANEL_APPLET_CFLAGS '-Dgtk_widget_get_realized(w)=GTK_WIDGET_REALIZED(w)' '-Dgtk_widget_get_mapped(w)=GTK_WIDGET_MAPPED(w)'")
 
 PKG_CHECK_MODULES(FISH, gtk+-2.0 >= $GTK_REQUIRED cairo >= $CAIRO_REQUIRED)
 AC_SUBST(FISH_CFLAGS)
